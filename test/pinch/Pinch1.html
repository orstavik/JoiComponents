<!DOCTYPE html>
<html lang="en">
<body>

<style>
  scale-block-one,
  scale-block-two,
  rotate-block {
    display: block;
    position: fixed;
    top: 100px;
    width: 300px;
    height: 300px;
  }
  scale-block-one {
    left: 100px;
    border: 4px solid red;
  }
  scale-block-two {
    left: 500px;
    border: 4px solid orange;
  }
  rotate-block {
    left: 900px;
    border: 4px solid blue;
    border-radius:  0 50% 50% 50%;
  }
</style>
<script src="//cdn.rawgit.com/hammerjs/touchemulator/0.0.2/touch-emulator.js"></script>
<script> TouchEmulator(); </script>

<scale-block-one>
  scale me!
</scale-block-one>
<scale-block-two>
  scale me!
</scale-block-two>
<rotate-block>
  rotate me!
</rotate-block>

<script type="module">

  import {PinchGesture} from "../../src/gestures/Pinch.js";

  class ScaleBlock1 extends PinchGesture(HTMLElement) {

    constructor() {
      super();
      this._onPinchListener = e => this._onPinch(e);
    }

    connectedCallback() {
      super.connectedCallback();
      this.addEventListener("pinch", this._onPinchListener);
    }

    disconnectedCallback() {
      super.disconnectedCallback();
      this.removeEventListener("pinch", this._onPinchListener);
    }

    _onPinch(e) {
      const width = e.detail.width / e.detail.startWidth;
      const height = e.detail.height / e.detail.startHeight;
      this.style.transform = `scaleX(${width}) scaleY(${height})`;
    }
  }

  class ScaleBlock2 extends PinchGesture(HTMLElement) {

    constructor() {
      super();
      this._onPinchListener = e => this._onPinch(e);
    }

    connectedCallback() {
      super.connectedCallback();
      this.addEventListener("pinch", this._onPinchListener);
    }

    disconnectedCallback() {
      super.disconnectedCallback();
      this.removeEventListener("pinch", this._onPinchListener);
    }

    _onPinch(e) {
      const diagonal = e.detail.diagonal / e.detail.startDiagonal;
      this.style.transform = `scale(${diagonal})`;
    }
  }

  class RotateBlock extends PinchGesture(HTMLElement) {

    constructor() {
      super();
      this._onPinchListener = e => this._onPinch(e);
    }

    connectedCallback() {
      super.connectedCallback();
      this.addEventListener("pinch", this._onPinchListener);
    }

    disconnectedCallback() {
      super.disconnectedCallback();
      this.removeEventListener("pinch", this._onPinchListener);
    }

    _onPinch(e) {
      const lastRotate = this.style.transform ? parseFloat(this.style.transform.substring(7)) : 0;
      this.style.transform = `rotate(${lastRotate + e.detail.rotation}deg)`;
    }
  }

  customElements.define("scale-block-one", ScaleBlock1);
  customElements.define("scale-block-two", ScaleBlock2);
  customElements.define("rotate-block", RotateBlock);
</script>

</body>
</html>