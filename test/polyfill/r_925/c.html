<!--<script src="polyfill-loader.js"></script>-->
<!--<script src="polyfill-loader.js" defer></script>-->
<script src="polyfill-bundle.js" onload="window.WebComponents.flushWaitingFunctions()"></script>
<!-- This works, when a bugfix call to customElements.upgrade is added in waitFor. But that should not be necessary. Why? -->
<!--<script defer src="polyfill-bundle.js" onload="window.WebComponents.flushWaitingFunctions()"></script>-->

<script type="module">
  window.WebComponents.waitFor(() => {
    class MyElement extends HTMLElement {
      connectedCallback() {
        this.style.display = "block";
        this.style.width = "200px";
        this.style.height = "250px";
        this.style.borderRadius = "50%";
        this.style.backgroundColor = "orange";
      }
    }

    console.log("customElements.define");
    customElements.define("my-element", MyElement);
  });

  setTimeout(
    () => {
      let me = document.createElement("my-element");
      document.body.appendChild(me);
      me.style.border = "20px dotted red";
    },
    2000
  );
  setTimeout(
    () => document.body.innerHTML += "<my-element></my-element>",
    3000
  );
</script>
<script>console.log("adding my-element"); </script>
<my-element></my-element>